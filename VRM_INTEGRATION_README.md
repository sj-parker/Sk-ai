# üé≠ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è VRM —Å –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é 3D –∞–≤–∞—Ç–∞—Ä–∞ VRM —Å –≥–æ–ª–æ—Å–æ–≤—ã–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
```bash
cd assistant
python main.py
```

### 2. –ó–∞–ø—É—Å–∫ VRM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
cd VRMoverlay
npm install
npm run dev
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
```bash
python test_vrm_integration.py
```

## üì° –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    WebSocket    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç     ‚îÇ ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îÇ   VRM Overlay   ‚îÇ
‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ TTS           ‚îÇ                 ‚îÇ ‚Ä¢ 3D –ê–≤–∞—Ç–∞—Ä     ‚îÇ
‚îÇ ‚Ä¢ LLM           ‚îÇ                 ‚îÇ ‚Ä¢ –ê–Ω–∏–º–∞—Ü–∏–∏      ‚îÇ
‚îÇ ‚Ä¢ –ü–∞–º—è—Ç—å        ‚îÇ                 ‚îÇ ‚Ä¢ –≠–º–æ—Ü–∏–∏        ‚îÇ
‚îÇ ‚Ä¢ –ß–∞—Ç-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è‚îÇ                 ‚îÇ ‚Ä¢ –¢–µ–∫—Å—Ç overlay ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è WebSocket
–í —Ñ–∞–π–ª–µ `assistant/config.yaml`:
```yaml
OVERLAY_WS_HOST: "192.168.1.4"  # –í–∞—à IP –∞–¥—Ä–µ—Å
OVERLAY_WS_PORT: 31992          # –ü–æ—Ä—Ç WebSocket
```

–í —Ñ–∞–π–ª–µ `VRMoverlay/src/vrm-websocket.js`:
```javascript
this.wsHost = '192.168.1.4'; // –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à IP
this.wsPort = 31992;         // –ü–æ—Ä—Ç WebSocket –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VRM –º–æ–¥–µ–ª–∏
1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à—É VRM –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É `VRMoverlay/public/`
2. –û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å –≤ `VRMoverlay/index.html`:
```html
<option value="your-model.vrm">Your Model</option>
```

## üì® –ü—Ä–æ—Ç–æ–∫–æ–ª WebSocket

### –ö–æ–º–∞–Ω–¥—ã –æ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∫ VRM:

#### –°—Ç–∞—Ç—É—Å
```json
{
  "type": "status",
  "status": "idle|talking|thinking|waiting"
}
```

#### –≠–º–æ—Ü–∏—è
```json
{
  "type": "emotion",
  "emotion": "happy|sad|angry|surprised|neutral",
  "intensity": 1.0,
  "duration": 2000
}
```

#### –ê–Ω–∏–º–∞—Ü–∏—è
```json
{
  "type": "animation",
  "animation": "idle|talking|thinking|greeting|breathing|stretching|surprise|excitement|listening",
  "duration": 5000
}
```

#### –¢–µ–∫—Å—Ç
```json
{
  "type": "text",
  "text": "–¢–µ–∫—Å—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è",
  "duration": 5000
}
```

#### –†–µ—á—å
```json
{
  "type": "speech",
  "isSpeaking": true|false,
  "text": "–¢–µ–∫—Å—Ç —Ä–µ—á–∏"
}
```

### –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è VRM –∫–ª–∏–µ–Ω—Ç–∞:
```json
{
  "type": "vrm_client",
  "client": "vrm_overlay",
  "version": "1.0"
}
```

## üéÆ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
- ‚úÖ **–≠–º–æ—Ü–∏–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏–∏ —Ä–µ—á–∏** - –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ TTS
- ‚úÖ **–°—Ç–∞—Ç—É—Å—ã** - thinking, talking, idle
- ‚úÖ **–¢–µ–∫—Å—Ç–æ–≤—ã–π overlay** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ—á–∏ –≤ VRM

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- ‚úÖ **–≠–º–æ—Ü–∏–∏** - –∫–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ VRM
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏–∏** - –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–≤–∏–∂–µ–Ω–∏–π
- ‚úÖ **–ü–æ–∑–∞** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—É–∫–∞–º–∏ –∏ —Ç–µ–ª–æ–º
- ‚úÖ **–ö–∞–º–µ—Ä–∞** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∫—É—Ä—Å–∞

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –≤ VRM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω:
```
‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥:
```bash
python test_vrm_integration.py
```

### –õ–æ–≥–∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞:
```
üé≠ VRM –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω. –í—Å–µ–≥–æ VRM –∫–ª–∏–µ–Ω—Ç–æ–≤: 1
```

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–º–æ—Ü–∏–π:
1. –í `assistant/audio_output.py` –¥–æ–±–∞–≤—å—Ç–µ —ç–º–æ–¥–∑–∏ –≤ `emoji_map`
2. –í `VRMoverlay/src/main.js` –¥–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `applyEmotion()`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π:
1. –í `VRMoverlay/src/main.js` —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é
2. –í `assistant/overlay_server.py` –¥–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ overlay:
–í `VRMoverlay/src/vrm-websocket.js` –∏–∑–º–µ–Ω–∏—Ç–µ `showTextOverlay()`.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–ª—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞:
- Python 3.8+
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `assistant/requirements.txt`
- Ollama —Å –º–æ–¥–µ–ª—å—é (gemma3:4b, phi3:mini, etc.)

### –î–ª—è VRM:
- Node.js 16+
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä —Å WebGL
- VRM –º–æ–¥–µ–ª—å (.vrm —Ñ–∞–π–ª)

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### VRM –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª

### –ê–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ VRM –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ—Å—Ç–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ –º–æ–¥–µ–ª–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

### –≠–º–æ—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ blend shapes –≤ VRM –º–æ–¥–µ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç–º–æ—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –∫–æ–¥–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
4. –°–æ–∑–¥–∞–π—Ç–µ issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

---

**–£–¥–∞—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏! üéâ** 