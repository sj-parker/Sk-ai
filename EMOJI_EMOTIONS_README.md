# 🎭 Система эмоций и смайликов

## Обзор

Система интегрирована с VRM оверлеем и автоматически распознает эмоции по смайликам в сообщениях ассистента, применяя соответствующие анимации к 3D модели.

## 🎯 Приоритетные смайлики для эмоций

### 😊 Радость (happy)
```
😊😄😉😃😆😂😅😏😜😋😇😎🥰😍😘😚😙😗😽😺😸😹😻😼
```

### 😢 Грусть (sad)
```
😢😭😐😔😞🥲🥹😿
```

### 😡 Злость (angry)
```
😡😤😾
```

### 😱 Удивление (surprised)
```
😱😬😳🙀
```

## 🎨 Характерные смайлики персонажа

Для сохранения характерного стиля персонажа Скай может использовать:
```
😈🖤😒
```
Эти смайлики **НЕ** триггерят эмоции в оверлее, но помогают передать характер персонажа.

## ⚙️ Как это работает

1. **Распознавание**: Система анализирует текст сообщения на наличие смайликов
2. **Определение эмоции**: Первый найденный смайлик определяет эмоцию
3. **Применение к VRM**: Эмоция передается в VRM оверлей через WebSocket
4. **Анимация**: VRM модель применяет соответствующую анимацию/морфинг
5. **Автосброс**: Эмоция автоматически сбрасывается через 2 секунды

## 📝 Настройка в ролях

Все роли в `config.yaml` и `role_manager.py` обновлены с указанием приоритетных смайликов:

```yaml
ROLES:
  telegram: "Ты общаешься живо, с эмоциями, можешь использовать любые эмодзи, но в приоритете те, что триггерят эмоции в оверлее: 😊😄😉😃😆😂😅😏😜😋😇😎🥰😍😘😚😙😗😽😺😸😹😻😼 (радость), 😢😭😐😔😞🥲🥹😿 (грусть), 😡😤😾 (злость), 😱😬😳🙀 (удивление). Также можешь использовать 😈🖤😒 для своего характерного стиля."
```

## 🧪 Тестирование

Запустите тест для проверки системы:
```bash
python test_emotion_emoji.py
```

## 📊 Примеры использования

### Радость
- "Привет! 😊 Как дела?"
- "Хахаха! 😂 Это смешно!"
- "Люблю тебя! 🥰"

### Грусть
- "Я так грущу сегодня 😢"
- "Ну вот опять... 😔"
- "Пока... 😭"

### Злость
- "Что за фигня! 😡"
- "Ты что делаешь?! 😤"

### Удивление
- "Ого! 😱 Не ожидал!"
- "Вау! 😳 Правда?"

### Характерный стиль
- "Мой характерный стиль 😈🖤" (не триггерит эмоцию)

## 🔧 Техническая реализация

- **Файл**: `assistant/audio_output.py` - функция `extract_emotion()`
- **WebSocket**: Команды отправляются в VRM оверлей
- **VRM**: Применяются morph targets для анимации эмоций
- **Длительность**: 2000ms (настраивается в `config.yaml`)

## 🎮 Интеграция с VRM

Система автоматически:
1. Отправляет команду `emotion` через WebSocket
2. VRM оверлей применяет соответствующую анимацию
3. Эмоция отображается на 3D модели
4. Автоматически возвращается к нейтральному состоянию 