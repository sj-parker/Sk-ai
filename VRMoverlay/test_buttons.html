<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫ VRM</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        .test-section h2 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: transform 0.2s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
        }
        
        .test-btn:active {
            transform: translateY(0);
        }
        
        .text-test {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .text-test input {
            flex: 1;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .text-test input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .duration-test {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .duration-test input {
            width: 100px;
            padding: 8px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .status {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .success {
            color: #28a745;
        }
        
        .error {
            color: #dc3545;
        }
        
        .info {
            color: #17a2b8;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ –¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫ –∏ —Ñ—É–Ω–∫—Ü–∏–π VRM</h1>
        
        <div class="test-section">
            <h2>üòä –¢–µ—Å—Ç —ç–º–æ—Ü–∏–π</h2>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ —ç–º–æ—Ü–∏–π:</p>
            <div class="button-grid">
                <button class="test-btn" onclick="testEmotion('manualBlink')">üòâ –ú–æ—Ä–≥–Ω—É—Ç—å</button>
                <button class="test-btn" onclick="testEmotion('setEmotion', 'happy')">üòä –†–∞–¥–æ—Å—Ç—å</button>
                <button class="test-btn" onclick="testEmotion('setEmotion', 'sad')">üò¢ –ì—Ä—É—Å—Ç—å</button>
                <button class="test-btn" onclick="testEmotion('setEmotion', 'angry')">üò† –ó–ª–æ—Å—Ç—å</button>
                <button class="test-btn" onclick="testEmotion('setEmotion', 'surprised')">üò≤ –£–¥–∏–≤–ª–µ–Ω–∏–µ</button>
                <button class="test-btn" onclick="testEmotion('setEmotion', 'neutral')">üòê –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ</button>
                <button class="test-btn" onclick="testEmotion('resetEmotions')">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —ç–º–æ—Ü–∏–∏</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üí¨ –¢–µ—Å—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–≤–µ—Ä–ª–µ—è</h2>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞:</p>
            <div class="text-test">
                <input type="text" id="testText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è..." value="–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç VRM –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞!">
                <button class="test-btn" onclick="testTextOverlay()">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
            </div>
            <div class="duration-test">
                <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º—Å):</label>
                <input type="number" id="testDuration" value="12000" min="3000" max="30000">
                <button class="test-btn" onclick="testTextOverlay()">–ü–æ–∫–∞–∑–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üé≠ –¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–π</h2>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏:</p>
            <div class="button-grid">
                <button class="test-btn" onclick="testAnimation('idle')">üõå –û–∂–∏–¥–∞–Ω–∏–µ</button>
                <button class="test-btn" onclick="testAnimation('talking')">üó£Ô∏è –†–∞–∑–≥–æ–≤–æ—Ä</button>
                <button class="test-btn" onclick="testAnimation('thinking')">ü§î –†–∞–∑–º—ã—à–ª–µ–Ω–∏–µ</button>
                <button class="test-btn" onclick="testAnimation('greeting')">üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</button>
                <button class="test-btn" onclick="testAnimation('surprise')">üò≤ –£–¥–∏–≤–ª–µ–Ω–∏–µ</button>
                <button class="test-btn" onclick="testAnimation('excitement')">üéâ –í–æ—Å—Ç–æ—Ä–≥</button>
            </div>
        </div>
        
        <div class="status" id="statusLog">
            <div class="info">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const statusLog = document.getElementById('statusLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.textContent = `[${timestamp}] ${message}`;
            statusLog.appendChild(logEntry);
            statusLog.scrollTop = statusLog.scrollHeight;
        }
        
        function testEmotion(action, emotion = null) {
            try {
                if (window.app) {
                    switch(action) {
                        case 'manualBlink':
                            window.app.manualBlink();
                            log('‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: –ú–æ—Ä–≥–∞–Ω–∏–µ', 'success');
                            break;
                        case 'setEmotion':
                            if (emotion) {
                                window.app.setEmotion(emotion);
                                log(`‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —ç–º–æ—Ü–∏—è: ${emotion}`, 'success');
                            }
                            break;
                        case 'resetEmotions':
                            window.app.resetEmotions();
                            log('‚úÖ –°–±—Ä–æ—à–µ–Ω—ã –≤—Å–µ —ç–º–æ—Ü–∏–∏', 'success');
                            break;
                        default:
                            log(`‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: ${action}`, 'error');
                    }
                } else {
                    log('‚ùå VRM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }
        
        function testTextOverlay() {
            try {
                const text = document.getElementById('testText').value;
                const duration = parseInt(document.getElementById('testDuration').value);
                
                if (!text.trim()) {
                    log('‚ùå –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'error');
                    return;
                }
                
                if (window.app && window.app.wsClient) {
                    // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
                    window.app.wsClient.handleText({
                        type: 'text',
                        text: text,
                        duration: duration
                    });
                    log(`‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω —Ç–µ–∫—Å—Ç: "${text}" (${duration}ms)`, 'success');
                } else {
                    log('‚ùå WebSocket –∫–ª–∏–µ–Ω—Ç –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }
        
        function testAnimation(animationName) {
            try {
                if (window.app && window.app.playMovement) {
                    window.app.playMovement(animationName);
                    log(`‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è: ${animationName}`, 'success');
                } else {
                    log('‚ùå –§—É–Ω–∫—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function checkAppStatus() {
            if (window.app) {
                log('‚úÖ VRM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ', 'success');
                if (window.app.wsClient) {
                    log('‚úÖ WebSocket –∫–ª–∏–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                } else {
                    log('‚ö†Ô∏è WebSocket –∫–ª–∏–µ–Ω—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'info');
                }
            } else {
                log('‚ùå VRM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ', 'error');
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            setTimeout(checkAppStatus, 1000);
        });
    </script>
</body>
</html> 