<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VRM Overlay Test</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: white;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #007acc;
            text-align: center;
        }
        
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        
        .test-section h2 {
            color: #007acc;
            margin-top: 0;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        button:hover {
            background: #005a9e;
        }
        
        button:active {
            background: #004080;
        }
        
        .status {
            background: #333;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .overlay-links {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .overlay-card {
            background: #333;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .overlay-card h3 {
            color: #007acc;
            margin-top: 0;
        }
        
        .overlay-card a {
            display: inline-block;
            background: #007acc;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 10px 5px;
        }
        
        .overlay-card a:hover {
            background: #005a9e;
        }
        
        .instructions {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .instructions h2 {
            color: #007acc;
            margin-top: 0;
        }
        
        .instructions ol {
            line-height: 1.6;
        }
        
        .instructions code {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≠ VRM Overlay Test</h1>
        
        <div class="test-section">
            <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ</h2>
            <div class="instructions">
                <ol>
                    <li>–ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à—É VRM –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É <code>web_overlay/static/models/</code></li>
                    <li>–û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ –≤ <code>config.yaml</code>:
                        <br><code>VRM_OVERLAY.model_path: '/static/models/your_model.vrm'</code>
                    </li>
                    <li>–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä: <code>python web_overlay/web_server.py</code></li>
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ –æ–¥–∏–Ω –∏–∑ –æ–≤–µ—Ä–ª–µ–µ–≤ –Ω–∏–∂–µ</li>
                    <li>–í OBS –¥–æ–±–∞–≤—å—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ "–ë—Ä–∞—É–∑–µ—Ä" —Å URL –æ–≤–µ—Ä–ª–µ—è</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîó –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–≤–µ—Ä–ª–µ–∏</h2>
            <div class="overlay-links">
                <div class="overlay-card">
                    <h3>–ë–∞–∑–æ–≤—ã–π VRM –æ–≤–µ—Ä–ª–µ–π</h3>
                    <p>–ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è —Å –±–∞–∑–æ–≤—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏</p>
                    <a href="/vrm" target="_blank">–û—Ç–∫—Ä—ã—Ç—å –±–∞–∑–æ–≤—ã–π –æ–≤–µ—Ä–ª–µ–π</a>
                </div>
                <div class="overlay-card">
                    <h3>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π VRM –æ–≤–µ—Ä–ª–µ–π</h3>
                    <p>–° –ª–∏–ø—Å–∏–Ω–∫–æ–º –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏</p>
                    <a href="/vrm-advanced" target="_blank">–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –æ–≤–µ—Ä–ª–µ–π</a>
                </div>
                <div class="overlay-card">
                    <h3>–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π VRM –æ–≤–µ—Ä–ª–µ–π</h3>
                    <p>–°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏</p>
                    <a href="/vrm-simple" target="_blank">–û—Ç–∫—Ä—ã—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π</a>
                </div>
                <div class="overlay-card">
                    <h3>–û—Ç–ª–∞–¥–æ—á–Ω—ã–π VRM –æ–≤–µ—Ä–ª–µ–π</h3>
                    <p>–î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≥—Ä—É–∑–∫–æ–π</p>
                    <a href="/vrm-debug" target="_blank">–û—Ç–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π</a>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üéÆ –¢–µ—Å—Ç WebSocket –∫–æ–º–∞–Ω–¥</h2>
            <p>–≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ WebSocket –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–≤–µ—Ä–ª–µ–µ–º:</p>
            
            <div class="button-group">
                <button onclick="sendCommand('start')">Start Talking</button>
                <button onclick="sendCommand('stop')">Stop Talking</button>
                <button onclick="sendCommand('waiting')">Waiting</button>
            </div>
            
            <div class="button-group">
                <button onclick="sendCommand('emotion:happy')">Happy</button>
                <button onclick="sendCommand('emotion:sad')">Sad</button>
                <button onclick="sendCommand('emotion:angry')">Angry</button>
                <button onclick="sendCommand('emotion:surprised')">Surprised</button>
            </div>
            
            <div class="status" id="status">
                –°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîß –¢–µ—Å—Ç WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</h2>
            <div class="button-group">
                <button onclick="testWebSocket()">–¢–µ—Å—Ç WebSocket</button>
                <button onclick="disconnectWebSocket()">–û—Ç–∫–ª—é—á–∏—Ç—å</button>
            </div>
            <div class="status" id="ws-status">
                WebSocket: –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìù –õ–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π</h2>
            <div class="status" id="log" style="max-height: 200px; overflow-y: auto;">
                –õ–æ–≥ –ø—É—Å—Ç
            </div>
        </div>
    </div>

    <script>
        let ws = null;
        let messageLog = [];
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            messageLog.push(`[${timestamp}] ${message}`);
            if (messageLog.length > 50) {
                messageLog.shift();
            }
            document.getElementById('log').textContent = messageLog.join('\n');
        }
        
        function updateStatus(message) {
            document.getElementById('status').textContent = `–°—Ç–∞—Ç—É—Å: ${message}`;
            log(message);
        }
        
        function updateWSStatus(message) {
            document.getElementById('ws-status').textContent = `WebSocket: ${message}`;
            log(`WS: ${message}`);
        }
        
        function sendCommand(command) {
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(command);
                updateStatus(`–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞: ${command}`);
            } else {
                updateStatus('WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
            }
        }
        
        function testWebSocket() {
            const wsHost = window.location.hostname;
            const wsPort = 31992; // –ü–æ—Ä—Ç –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            
            try {
                ws = new WebSocket(`ws://${wsHost}:${wsPort}`);
                
                ws.onopen = () => {
                    updateWSStatus('–ü–æ–¥–∫–ª—é—á–µ–Ω');
                    updateStatus('WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                };
                
                ws.onmessage = (event) => {
                    log(`–ü–æ–ª—É—á–µ–Ω–æ: ${event.data}`);
                };
                
                ws.onclose = () => {
                    updateWSStatus('–û—Ç–∫–ª—é—á–µ–Ω');
                    updateStatus('WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ');
                };
                
                ws.onerror = (error) => {
                    updateWSStatus('–û—à–∏–±–∫–∞');
                    updateStatus('–û—à–∏–±–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
                    log(`WS Error: ${error}`);
                };
                
            } catch (error) {
                updateWSStatus('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
                updateStatus(`–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        function disconnectWebSocket() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            updateStatus('–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é');
        });
    </script>
</body>
</html> 